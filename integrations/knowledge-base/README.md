# Knowledge Base — Self-Hosted File Server

## The Goal

Create a **web-accessible knowledge base** where you can browse and view:
- Markdown files (rendered beautifully)
- YAML configurations
- Code snippets
- Documentation

All running locally in a **Podman container** without external dependencies.

---

## Architecture

```
Your Files
    ↓
Nginx (Container)
    ↓
Beautiful Web UI (index.html + Prism.js)
    ↓
Browser (Markdown + Code Syntax Highlighting)
```

---

## Files in This Directory

- **`nginx.conf`** — Nginx reverse proxy configuration (auto-generated by Molty)
- **`index.html`** — Custom web UI with Markdown/YAML viewer (auto-generated by Molty)

### How These Were Created

When Chris said: *"Build a web server to show me files in a browser"*, Molty didn't give instructions — he **built it himself**:
1. Created a custom `index.html` with Prism.js for syntax highlighting
2. Wrote `nginx.conf` to serve files with directory listing
3. Deployed it in a Podman container
4. Added YAML support when asked

This is the core of the Agent pattern: You describe the goal, the Agent produces working infrastructure.

---

## Prerequisites

1. **Podman or Docker** installed and running
2. **Port 8080 available** (or modify to a different port)
3. **Your files** in a folder (e.g., `/home/molty/public_share/files/`)

---

## Setup

### Step 1: Prepare Your Files

Create a directory with the files you want to serve:

```bash
mkdir -p /home/molty/public_share/files
# Put your .md, .yaml, .txt files here
```

### Step 2: Copy Configuration Files

Place `nginx.conf` and `index.html` in your project:

```bash
# Example structure:
/home/molty/public_share/
├── files/
│   ├── INSTALL_MOLTY.md
│   ├── ols-config.yaml
│   └── ... (your files)
├── nginx.conf
└── index.html
```

### Step 3: Start the Container

```bash
podman run --rm -d -p 8080:80 \
  -v /home/molty/public_share:/usr/share/nginx/html:ro,Z \
  -v /home/molty/public_share/nginx.conf:/etc/nginx/conf.d/default.conf:ro,Z \
  --name molty-web \
  nginx:alpine
```

**What this does:**
- `--rm` — Clean up when stopped
- `-d` — Run in background
- `-p 8080:80` — Map port 8080 on host to port 80 in container
- `-v /home/molty/public_share:/usr/share/nginx/html:ro,Z` — Mount files (read-only)
- `-v .../nginx.conf:...` — Use custom Nginx config
- `nginx:alpine` — Lightweight Alpine Linux image

### Step 4: Access the Knowledge Base

Open your browser:
```
http://localhost:8080
```

You'll see a directory listing. Click on `.md` or `.yaml` files to view them with syntax highlighting!

---

## Features

### Markdown Rendering
- Files ending in `.md` are rendered with proper formatting
- Headers, lists, code blocks are styled
- Links work automatically

### YAML Syntax Highlighting
- YAML files are displayed with color-coded syntax
- Easy to read configuration files

### Code Rendering
- JavaScript, Python, Bash, and other languages highlighted
- Clean, readable code blocks

### Directory Navigation
- Click folders to browse
- Click files to view

---

## Customization

### Change Port

If 8080 is busy, use a different port:

```bash
podman run --rm -d -p 9000:80 \  # ← Change 9000 to your port
  -v /home/molty/public_share:/usr/share/nginx/html:ro,Z \
  -v /home/molty/public_share/nginx.conf:/etc/nginx/conf.d/default.conf:ro,Z \
  --name molty-web \
  nginx:alpine
```

Then access: `http://localhost:9000`

### Add More File Types

Edit `index.html` to add more language support. Look for the `Prism.js` language imports and add new ones.

### Persistent Naming

If you want the container to persist (restart on reboot):

```bash
podman run -d -p 8080:80 \
  --restart=always \
  ... (rest of command)
```

---

## Stopping the Container

```bash
podman stop molty-web
```

---

## Troubleshooting

### Port 8080 is already in use
```bash
# Find what's using it
sudo lsof -i :8080

# Or use a different port (see Customization above)
```

### Can't see files
- Make sure files are in `/home/molty/public_share/files/`
- Check permissions: `ls -la /home/molty/public_share/`
- Verify the mount is correct in podman run command

### Nginx won't start
- Check logs: `podman logs molty-web`
- Verify `nginx.conf` is valid

### SELinux permissions (if using Fedora)
- The `:Z` flag in the mount fixes most SELinux issues
- If still blocked, check: `sudo semanage fcontext -a -t container_file_t "/path/to/files(/.*)?"`

---

## Evolution

**Initial Version (2026-02-03):**
- Basic Markdown + YAML rendering
- Directory listing
- Code syntax highlighting

**Future Ideas:**
- Search function
- Dark mode toggle
- Full-text indexing
- Markdown TOC generator

---

## References

- [Nginx Documentation](https://nginx.org/)
- [Podman Documentation](https://podman.io/)
- [Prism.js](https://prismjs.com/) (Syntax highlighting)

---

**Last Updated:** 2026-02-03  
**Status:** ✅ Running and tested
